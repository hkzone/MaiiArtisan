<%- include("./_header") -%> <% if(cart && cart.items.length > 0) { %>
<main class="main container-xl">
  <div class="cart-wrapper">
  <h2>Cart</h2>
    <form action="/cart/update" method="post" class='form cart__update'>
      <table class="cart-table table ">
        <thead>
          <tr>
            <th scope="col">Picture</th>
            <th scope="col">Name</th>
            <th scope="col">Price</th>
            <th scope="col">Quantity</th>
            <th scope="col">Remove</th>
          </tr>
        </thead>
        <tbody>
          <% cart.items.forEach(function(product) { %>
          <tr>
            <td class="product-thumb">
              <img
                src="/images/products/<%= product.imageCover %>"
                alt=""
                class="img-thumbnail img-responsive"
              />
            </td>
            <td><%= product.name %></td>
            <td><%= product.price %></td>
            <td>
              <input
                class="qty"
                type="text"
                name="qty[]"
                value="<%= product.qty %>"
                data-productId =<%= product._id%>
              />
              <input
                type="hidden"
                class="product_id"
                name="product_id[]"
                value="<%= product._id%>"
              />
            </td>
             <td>
              <a href="/cart/remove/<%= product._id%>/<%= nonce %>">
                <i class="fas fa-minus"></i>
              </a>
            </td>
          </tr>

          <% }); %>
          <tr class="info">
            <td colspan="5" class="text-right">
              Total: <%= cart.formattedTotals %>
            </td>
          </tr>
        </tbody>
      </table>
      <div class="clearfix cart-footer">
        <input class ='nonce' type="hidden" name="nonce" value="<%= nonce %>" />
        <button type="submit" class="btn btn-default pull-left">
          <i class="fas fa-sync"></i> Update cart
        </button>
        <a href="/cart/empty/<%= nonce %>" class="btn btn-default pull-left"
          ><i class="fas fa-trash"></i> Empty cart</a
        >
        <button type="button" class="btn btn-default pull-right chekoutBtn"
          >Checkout <i class="fas fa-shopping-cart"></i></i
        ></a>
      </div>
    </form>
    <% } else { %>
    <p class="alert alert-info">Sorry, no products in your cart.</p>
      </div>
</main>
<% } %> <%- include("./_footer") -%>


